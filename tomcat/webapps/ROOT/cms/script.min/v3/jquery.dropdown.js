!function(e,t,s){var o,i,n=e(t),a=t.document,r=e(a);require(["string"],function(t){e.plugin2("dropDown",{_defaultOptions:{classPrefix:"dropDown-"},className:function(e){return this.option("classPrefix")+e},_create:function(s){function l(){var e=d.offset(),t=d.outerWidth(!0),s=n.scrollTop(),o=n.height();if(t>f.outerWidth(!0)&&f.css("min-width",t+20),e.top-s<.6*o){var i=d.outerHeight(),a=e.top+i;D&&(a-=n.scrollTop()),g.css("max-height",s+o-e.top-i),d.add(f).add(u).removeClass("dropDown-input-bottom"),f.add(u).css({bottom:"",left:e.left,top:a})}else{var r=o-e.top;D&&(r+=n.scrollTop()),g.css("max-height",e.top-s),d.add(f).add(u).addClass("dropDown-input-bottom"),f.add(u).css({bottom:r,left:e.left,top:""})}u.css("width",d.outerWidth())}var d,c,p,h,u,m,f,g,v,w=this,b=e(s),D=b.isFixedPosition(),N=b.is("[multiple]"),x=b.is('[data-searchable="true"]'),k=b.attr("placeholder"),C=b.attr("data-dynamic-placeholder"),y=C&&"<span data-dynamic-text="+C+">";N||0!==b.find("option:selected").length||b.find("option:first").prop("selected",!0),b.bind("input-disable",function(e,t){d.toggleClass("state-disabled",t)}),d=e("<div/>",{"class":w.className("input"),css:{"margin-bottom":b.css("margin-bottom"),"margin-left":b.css("margin-left"),"margin-right":b.css("margin-right"),"margin-top":b.css("margin-top"),position:"relative",width:N?"auto":b.outerWidth()}}),d.click(function(){return c.is(":visible")?c.click():d.hasClass(w.className("list-open"))?g.trigger("dropDown-close"):p.click(),!1}),c=e("<a/>",{"class":w.className("label"),href:"#",click:function(){return d.is(".state-disabled")||(i&&i[0]===g[0]?g.trigger("dropDown-close"):g.trigger("dropDown-open")),!1}}),c.bind("dropDown-update",function(){var t=e.map(b.find("option:selected"),function(t){return e(t).text()}).join(", ");c.html(t||y||k||"&nbsp;"),c.toggleClass("state-placeholder",!t),l()}),h={display:"none",position:D?"fixed":"absolute","z-index":b.zIndex()},u=e("<div/>",{css:h}),m=e("<div/>",{"class":w.className("marker")}),f=e("<div/>",{"class":w.className("container"),css:h}),g=e("<div/>",{"class":w.className("list")}),g.bind("dropDown-open",function(){l(),d.addClass(w.className("list-open")),g.find("."+w.className("listItem")).removeClass("state-hover"),g.find("."+w.className("listItem")+(N?":first":":has(:checked)")).addClass("state-hover"),i&&i.trigger("dropDown-close"),o=b,i=g,u.show(),f.show()}),g.bind("dropDown-close",function(){d.removeClass(w.className("list-open")),o=null,i=null,u.hide(),f.hide(),N&&b.change()}),g.bind("dropDown-hover",function(e,t){g.find("."+w.className("listItem")).removeClass("state-hover"),t&&t.addClass("state-hover")}),g.bind("mousewheel",function(t,s,o,i){var n=e(this),a=e.data(this,"dropDown-maxScrollTop");"undefined"==typeof a&&(a=n.prop("scrollHeight")-n.innerHeight(),e.data(this,"dropDown-maxScrollTop",a)),(i>0&&0===n.scrollTop()||0>i&&n.scrollTop()>=a)&&t.preventDefault()}),r.mousedown(function(t){!f.is(":visible")||e.contains(f[0],t.target)||d[0]===t.target||e.contains(d[0],t.target)||g.trigger("dropDown-close")}),v=function(t){var s,o;s=e("<div/>",{"class":w.className("listItem"),html:t.text()||"&nbsp;"}),o=e("<input/>",{type:N?"checkbox":"radio"}),t.is(":selected")&&(o.prop("checked",!0),s.addClass(w.className("listItem-selected"))),s.mouseenter(function(){g.trigger("dropDown-hover",[s])}),s.mouseleave(function(){g.trigger("dropDown-hover")}),s.click(N?function(){return t.is(":selected")?(t.prop("selected",!1),s.find(":checkbox").prop("checked",!1),s.removeClass(w.className("listItem-selected"))):(t.prop("selected",!0),s.find(":checkbox").prop("checked",!0),s.addClass(w.className("listItem-selected"))),c.trigger("dropDown-update"),!1}:function(){return t.is(":selected")||(b.find("option").prop("selected",!1),g.find(":radio").prop("checked",!1),g.find("."+w.className("listItem")).removeClass(w.className("listItem-selected")),t.prop("selected",!0),o.prop("checked",!0),s.addClass(w.className("listItem-selected")),c.trigger("dropDown-update"),b.change()),g.trigger("dropDown-close"),!1}),s.prepend(" "),s.prepend(o),g.append(s)},b.find("> optgroup, > option").each(function(){var t=e(this);t.is("option")?v(t):(g.append(e("<div/>",{"class":w.className("listGroupLabel"),text:t.attr("label")})),t.find("> option").each(function(){v(e(this))}))}),c.trigger("dropDown-update"),d.append(c),b.before(d),b.hide(),f.append(g),e(a.body).append(f),f.css("min-width",f.outerWidth()),u.append(m),e(a.body).append(u),x&&(p=e("<input/>",{"class":w.className("search"),type:"text"}),p.bind("input",function(){var s,o=new RegExp(t(p.val().replace(/\s/,"").split("").join("(?:.*\\W)?")).latinise().s,"i");g.find("."+w.className("listItem")).each(function(){var i=e(this);o.test(t(i.text()).latinise().s)?(i.show(),s||(s=i)):i.hide()}),g.trigger("dropDown-hover",[s])}),p.click(function(){return!1}),g.bind("dropDown-open",function(){c.hide(),g.find("."+w.className("listItem")).show(),p.val(c.text()),p.show(),p.focus(),p.select()}),g.bind("dropDown-close",function(){c.show(),p.hide()}),p.hide(),d.append(p))}}),r.keydown(function(e){var t,s,n,a,r,l,d;if(i&&(t=e.which,s=38===t,!(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey))){if(n=o.dropDown("className","listItem"),s||40===t)return a=i.find(".state-hover:visible."+n).eq(0),a=0===a.length?i.find(":visible."+n).eq(s?-1:0):a[s?"prevAll":"nextAll"](":visible."+n).eq(0),a.length>0&&(i.trigger("dropDown-hover",[a]),r=a.position().top,l=a.outerHeight(),s?0>r&&i.scrollTop(i.scrollTop()+r):(d=r+l-i.height(),d>0&&i.scrollTop(i.scrollTop()+d))),!1;if(13===t)return i.find(".state-hover."+n).click(),!1;if(27===t)return i.trigger("dropDown-close"),!1}return!0})})}(jQuery,window);