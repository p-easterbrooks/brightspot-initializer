define(["jquery","bsp-utils"],function(t,o){var e=".withLeftNav > .leftNav, .withLeftNav > .main, .contentForm-main, .contentForm-aside",a="cs-visible",i="cs-topOriginal",s="cs-height";o.onDomInsert(document,e,{insert:function(o){t(o).css({"margin-bottom":0,position:"relative",top:0})}});var n=0,c=0,r=t(window);r.scroll(o.throttle(1e3,function(){n=t(document.body).height(),c=t(".toolHeader").outerHeight(!0),t(e).each(function(){var o=this,e=t(o);t.data(o,a,e.is(":visible")),t.data(o,i,e.offset().top-(parseInt(e.css("top"),10)||0)),t.data(o,s,e.outerHeight())})}));var l=r.scrollTop();r.scroll(function(){var o=r.scrollTop(),p=r.height();t(e).each(function(){function e(t){var e=Math.max(o-(t||0),0);h.css({"margin-bottom":e,top:e})}var r=this,h=t(r);if(!(!t.data(r,a)||h.closest('.popup[data-popup-source-class="objectId-select"]').length>0||h.closest(".popup-objectId-edit-loaded").length>0)){var d=t.data(r,i),f=t.data(r,s),u=h.offset().top;if(p>d+f)e();else if(o>l){var m=o+p;if(m>u+f){var v=Math.max(Math.min(m-f-d,n-f-d),0);h.css({"margin-bottom":v,top:v})}}else l>o&&u>o+c&&e(d-c)}}),l=o})});