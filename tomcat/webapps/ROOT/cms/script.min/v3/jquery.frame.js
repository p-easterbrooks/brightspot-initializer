!function(e,a,t){var r=e(a),n=a.document,o=0;e.plugin2("frame",{_defaultOptions:{frameClassName:"dari-frame",loadingClassName:"dari-frame-loading",loadedClassName:"dari-frame-loaded",bodyClassName:"dari-frame-body",setBody:function(a){e(this).html(a)}},_init:function(a,t){var i,d,f,m,c=this,l=c.$caller,s=t.frameClassName,u=t.loadingClassName,p=t.loadedClassName;t.bodyClassName;return i=function(a,t){var r,o=e(a),i=o.attr("href")||"",d=o.attr("data-frame-target")||o.attr("target");if(d&&e('frame[name="'+d+'"], iframe[name="'+d+'"]').length>0)return!0;if("_top"!==d&&"_blank"!==d){if("_parent"===d)r=o.frame("container").parent().frame("container");else if(d)r=e("."+s+'[name="'+d+'"]'),0===r.length&&(r=e("<div/>",{"class":s,name:d}),e(n.body).append(r),r.popup());else if(r=o.frame("container"),0===i.indexOf("#"))return!0;if(r.length>0&&r[0]!==n)return t(o,r)}return!0},d=function(a,t,r){var n=(a.data("frame-loadVersion")||0)+1,o=a.popup("container");return a.add(o).removeClass(p).addClass(u),a.data("frame-loadVersion",n),a.data("frame-$source",t),o[0]&&t[0]&&!e.contains(o[0],t[0])&&(a.popup("source",t,r),a.empty()),0==a.parent().frame("container").length&&a.popup("open"),n},f=function(e,a,n){var o,i;a>=e.data("frame-loadVersion")&&(o=e.popup("container"),i=n,i=i.replace(/^[^]*?<body[^>]*>/gi,""),i=i.replace(/<\/body>[^]*?$/gi,""),e.add(o).removeClass(u).addClass(p),t.setBody.call(e[0],i),e.trigger("create"),e.trigger("load"),e.trigger("frame-load"),r.resize())},m=function(a,t,r,n,o,i){var m=d(a,t,i),c=a.attr("data-extra-form-data");c&&(n+=(n.indexOf("?")<0?"?":"&")+c),e.ajax({cache:!1,type:r,url:n,data:o,complete:function(e){f(a,m,e.responseText)}})},l.delegate("a","click.frame",function(e){return i(this,function(a,t){return m(t,a,"get",a.attr("href"),null,e),!1})}),l.on("change",":checkbox[data-frame-target]",function(e){return i(this,function(a,t){var r=a.prop("checked")?a.attr("data-frame-check"):a.attr("data-frame-uncheck");m(t,a,"get",r,null,e)})}),l.delegate("form","click.frame",function(a){e(a.target).is('button, input[type="submit"]')&&e.data(this,"frame-clicked",a.target)}),l.delegate("form","submit.frame",function(){return i(this,function(a,t){var r,i,c=a.attr("action"),l=t.attr("data-extra-form-data"),s=e.data(a[0],"frame-clicked");if(s&&(r=e(s).prop("name"),i=e(s).prop("value"),r&&i&&(c+=(c.indexOf("?")>-1?"&":"?")+encodeURIComponent(r)+"="+encodeURIComponent(i))),"multipart/form-data"!==a.attr("enctype"))return m(t,a,a.attr("method"),c,a.serialize()),!1;a.attr("action",c+(c.indexOf("?")<0?"?":"&")+l),0===a.find('input[type="hidden"][name="_frame"]').length&&a.prepend(e("<input/>",{name:"_frame",type:"hidden",value:"true"}));var u=a.attr("target"),p=!0;u||(o+=1,u="frameTarget"+o+ +new Date,a.attr("target",u),p=!1);var g=e("iframe[name="+u+"]");0===g.length&&(g=e("<iframe/>",{name:u}),g.hide(),e(n.body).append(g));var h=d(t,a);return g.unbind(".frame"),g.bind("load.frame",function(){a.attr("action",c),f(t,h,g.contents().find("textarea#frameBody").val()||g.contents().find("body").html()),p||(a.removeAttr("target"),setTimeout(function(){g.remove()},0))}),!0})}),l.onCreate("."+s,function(){var a,t=e(this);t.is(":not(."+u+"):not(."+p+")")&&(a=t.find("a:only-child:not([target])"),a.length>0?a.click():t.find("form:only-child:not([target])").submit())}),l},container:function(){return this.$caller.closest("."+this.option("frameClassName"))},source:function(){return this.container().data("frame-$source")}})}(jQuery,window);