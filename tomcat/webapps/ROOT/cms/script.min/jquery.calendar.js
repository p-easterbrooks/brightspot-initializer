!function(e,a,t){var n,d={dayLabels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"]},s=function(e){return 10>e?"0"+e:e},l=function(a){var t=n(),d=t.data("selectedDate");t.data("viewDate",a);var s=a.getMonth();t.find("> .monthYear > .month").val(s),t.find("> .monthYear > .year").val(a.getFullYear());var l=new Date(a.getTime());l.setDate(1),l.setDate(l.getDate()-l.getDay()),t.find("> .week > .day").each(function(){var a=e(this);a.data("date",new Date(l.getTime()));var t=l.getDate();a.text(t),s===l.getMonth()?a.removeClass("offMonth"):a.addClass("offMonth"),l.getMonth()===d.getMonth()&&t===d.getDate()?a.addClass("selected"):a.removeClass("selected"),l.setDate(t+1)})},r=function(){var e=n(),a=e.data("selectedDate"),t=s(a.getDate()),l=a.getHours(),r=s(a.getMinutes()),c="AM";l>=12&&(l-=12,c="PM"),l=0===l?12:s(l);var p=e.data("$input");p.val(a.getFullYear()+"-"+s(a.getMonth()+1)+"-"+s(a.getDate())+" "+s(a.getHours())+":"+s(a.getMinutes())+":00"),p.change(),e.data("$calendarButton").toggleClass("calendarButton-empty",!p.val()),e.data("$calendarButton").text(d.dayLabels[a.getDay()]+", "+d.monthLabels[a.getMonth()].substring(0,3)+" "+t+", "+a.getFullYear()+", "+l+":"+r+" "+c)};n=function(){var a=e("#calendar");if(0===a.length){a=e("<div/>",{id:"calendar"});var t=e("<div/>",{"class":"monthYear"}),n=e("<select/>",{"class":"month",change:function(){var e=new Date(a.data("viewDate").getTime());e.setDate(1),e.setMonth(n.val()),l(e)}});t.append(n),e.each(d.monthLabels,function(a,t){n.append(e("<option/>",{value:a,text:t}))});var c=e("<input/>",{type:"text","class":"year",bind:{input:function(){var e=parseInt(c.val(),10)||0;if(1900>e)c.addClass("invalid");else{var t=new Date(a.data("viewDate").getTime());t.setDate(1),t.setYear(e),l(t),a.data("selectedDate").setYear(e),c.removeClass("invalid")}}}});t.append(" "),t.append(c);var p=e("<span/>",{"class":"previousButton"});p.bind("click.calendar",function(){var e=new Date(a.data("viewDate").getTime());e.setDate(1),e.setMonth(e.getMonth()-1),l(e)});var i=e("<span/>",{"class":"nextButton"});i.bind("click.calendar",function(){var e=new Date(a.data("viewDate").getTime());e.setDate(1),e.setMonth(e.getMonth()+1),l(e)});var o=e("<div/>",{"class":"dayLabels"});e.each(d.dayLabels,function(a,t){o.append(e("<span/>",{"class":"day day"+a,text:t}))}),a.append(t),a.append(p),a.append(i),a.append(o);var u,v,g;for(u=0;6>u;++u){for(v=e("<div/>",{"class":"week week"+u}),g=0;7>g;++g)v.append(e("<span/>",{"class":"day day"+g}));a.append(v)}var h=e("<div/>",{"class":"time"});if(COMMON_TIMES.length>0){var f=e("<select/>",{"class":"timeSelect",change:function(){var t,n=e(this).find(":selected"),d="_custom"===n.prop("value");D.add(C).add(m).toggle(d),d||(t=a.data("selectedDate"),t.setHours(parseInt(n.attr("data-hour"),10)),t.setMinutes(parseInt(n.attr("data-minute"),10)))}});e.each(COMMON_TIMES,function(){f.append(e("<option/>",{text:this.displayName,"data-hour":this.hour,"data-minute":this.minute}))}),f.append(e("<option/>",{text:"Custom:",value:"_custom"}))}var m=e("<select/>",{"class":"meridiem"}),D=e("<select/>",{"class":"hour"}),M=function(){a.data("selectedDate").setHours(("PM"===m.val()?12:0)+parseInt(D.val(),10))};m.append(e("<option/>",{text:"AM",value:"AM"})),m.append(e("<option/>",{text:"PM",value:"PM"})),m.change(M);var y,b;for(y=0;12>y;++y)b=0===y?12:s(y),D.append(e("<option/>",{text:b,value:y}));D.change(M);var w,x,C=e("<select/>",{"class":"minute"});for(w=0;60>w;++w)x=s(w),C.append(e("<option/>",{text:x,value:w}));C.change(function(){a.data("selectedDate").setMinutes(C.val())}),h.append(f),h.append(D),h.append(C),h.append(m),a.append(h);var I=e("<div/>",{"class":"calendar_actions"});I.append(e("<span/>",{"class":"calendar_set",text:"Set",click:function(){a.data("$input");r(),a.popup("close")}})),I.append(e("<span/>",{"class":"calendar_clear",text:"Clear",click:function(){var e=a.data("$input");a.data("selectedDate",new Date),e.val(""),e.change(),a.data("$calendarButton").toggleClass("calendarButton-empty",!e.val()),a.data("$calendarButton").text(e.val()||e.attr("placeholder")||e.attr("data-emptylabel")||"N/A"),a.popup("close")}})),a.append(I),e("body").append(a),a.popup(),a.popup("container").attr("id","calendarPopup"),a.popup("close"),a.find(".day").click(function(){var t=e(this).data("date");a.data("selectedDate",t),a.find(".timeSelect").change(),l(t)})}return a},e.plugin2("calendar",{_create:function(a){var t=e(a),d=e("<span/>",{"class":"calendarButton",text:t.val()||t.attr("placeholder")||t.attr("data-emptylabel")||"N/A"});t.bind("input-disable",function(e,a){d.toggleClass("state-disabled",a)}),d.toggleClass("calendarButton-empty",!t.val()),d.click(function(){if(!d.is(".state-disabled")){var e=n();e.data("$input",t),e.data("$calendarButton",d);var a=t.val(),s=new Date;if(a){var r=/^(\d\d\d\d)-(\d\d)-(\d\d) (\d\d):(\d\d):(\d\d)?$/.exec(a);r&&(s.setFullYear(parseInt(r[1],10)),s.setMonth(parseInt(r[2],10)-1),s.setDate(parseInt(r[3],10)),s.setHours(parseInt(r[4],10)),s.setMinutes(parseInt(r[5],10)),s.setSeconds(parseInt(r[6],10)))}e.data("selectedDate",s),l(s);var c=s.getHours(),p="AM";c>=12&&(c-=12,p="PM"),e.find("select.hour").val(c),e.find("select.minute").val(s.getMinutes()),e.find("select.meridiem").val(p),e.find("select.timeSelect").change(),e.find(".empty").text(t.attr("placeholder")||t.attr("data-emptylabel")||"N/A"),e.popup("source",d),e.popup("open")}}),t.hide(),t.after(d)}})}(jQuery,window);