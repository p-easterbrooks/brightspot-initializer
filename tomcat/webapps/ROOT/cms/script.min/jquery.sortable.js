!function(e,t,a){function r(t){var a=t.attr("data-sortable-item-type");return a?e('[data-sortable-valid-item-types~="'+a+'"]'):e()}var o=e(t);e(t.document);e.plugin2("sortable",{_defaultOptions:{itemSelector:"> *"},_create:function(t){var a=e(t),l=this.option();a.addClass("_sortable"),a.find(l.itemSelector).addClass("_sortable-item"),a.delegate(l.itemSelector,"mousedown.sortable",function(n){var i=e(n.target);i.closest("._sortable")[0]===t&&(i.is(":input")||i.closest(".CodeMirror").length>0||n.pageX>i.offset().left+i.outerWidth()-20||e.drag(this,n,function(t,a){var l=e(this),n=l.offset();a.originalStyle=l.attr("style"),l.height(l.height()),l.width(l.width()),a.$placeholder=l.clone().empty(),l.before(a.$placeholder),a.adjustX=n.left-t.pageX,a.adjustY=n.top-t.pageY,l.addClass("sortable-dragging"),l.css({display:"block",left:t.pageX-o.scrollLeft()+a.adjustX,position:"fixed",top:t.pageY-o.scrollTop()+a.adjustY,"z-index":1e6}),a.$parents=l.parentsUntil(".toolContent"),a.$parents.addClass("sortable-parent");var i=r(l);i.length>1&&i.addClass("sortable-droppable")},function(t,a){var n,i,s=e(this);s.css({left:t.pageX-o.scrollLeft()+a.adjustX,top:t.pageY-o.scrollTop()+a.adjustY}),s.hide(),a.$dragCover.hide();var d=e.elementFromPoint(t.clientX,t.clientY)[0];if(d&&r(s).sortDepthFirst().each(function(){var t=e(this),a=t.find(l.itemSelector).not(s);return a.each(function(){return e.contains(this,d)?(n=t,i=e(this),!1):void 0}),(t.is(d)||e.contains(t[0],d))&&(n=t),n?!1:void 0}),n)if(i&&i.length>0&&i[0]!==a.$placeholder[0]){var c,p=n.find(l.itemSelector),h=Array.prototype.indexOf.call(p,a.$placeholder[0]),f=Array.prototype.indexOf.call(p,i[0]);c=-1===h?"after":h>f?"before":"after",i[c](a.$placeholder)}else e.contains(n[0],a.$placeholder[0])||n.append(a.$placeholder);s.show(),a.$dragCover.show()},function(t,o){var l=e(this);l.removeClass("sortable-dragging"),o.originalStyle?l.attr("style",o.originalStyle):l.removeAttr("style"),l.find(".richtext").each(function(){var t=e(this),a=t.closest(".inputContainer").find(".rte-container iframe");0!==a.length&&t.val(e(a[0].contentDocument.body).html())}),o.$placeholder.next()[0]!==l[0]&&o.$placeholder.after(l),o.$placeholder.remove();var n=a.attr("data-sortable-input-name"),i=l.closest("._sortable").attr("data-sortable-input-name");n!==i&&l.find('[name^="'+n+'"]').each(function(){var t=e(this);t.attr("name",t.attr("name").replace(n,i))}),l.find(".richtext").each(function(){var t=e(this),a=t.closest(".inputContainer").find(".rte-container iframe");if(0!==a.length){var r=t.val(),o=t.closest(".inputContainer");t=t.clone();var l=o.find(".rte-container");t.val(r),l.after(t),l.remove(),t.removeClass("plugin-expandable plugin-rte rte-textarea rte-source"),t.show(),o.trigger("create")}}),o.$parents.removeClass("sortable-parent"),r(l).removeClass("sortable-droppable"),a.trigger("sortable.end",[this])}))})}})}(jQuery,window);